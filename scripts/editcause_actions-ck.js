function updateActionForm(){var e=document.getElementById("action_type").value;if(e=="petition"){document.getElementById("action_text").value="Sign this Petition";document.getElementById("causehubmodules").style.display="block";document.getElementById("communitymodules").style.display="none"}else if(e=="event"){document.getElementById("action_text").value="Host an Event";document.getElementById("causehubmodules").style.display="block";document.getElementById("communitymodules").style.display="none"}else if(e=="other"){document.getElementById("action_text").value="";document.getElementById("causehubmodules").style.display="block";document.getElementById("communitymodules").style.display="none"}else{document.getElementById("communitymodules").style.display="block";document.getElementById("causehubmodules").style.display="none";document.getElementById("communitymoduleform").action="/modules/"+document.getElementById("action_type").value+"/scripts/edit_form.php";updateEditForm()}}function addAction(){causeid=document.getElementById("causeid");action_type=document.getElementById("action_type");action_text=document.getElementById("action_text");action_link=document.getElementById("action_link");action_btn=document.getElementById("action_btn");action_text.style.borderColor="#999";action_link.style.borderColor="#999";if(action_text.value==""){alertify.log("No action text entered","error");action_text.style.borderColor="red";return!1}if(action_link.value==""){alertify.log("No action link entered","error");action_link.style.borderColor="red";return!1}var e="cid="+causeid.value+"&actiontype="+action_type.value+"&actiontext="+action_text.value+"&actionlink="+action_link.value;$.ajax({type:"POST",url:"/scripts/processing/addaction.php",data:e,beforeSend:function(){action_btn.disabled=!0;action_type.disabled=!0;action_text.disabled=!0;action_link.disabled=!0;action_btn.value="Processing"},error:function(){action_btn.disabled=!1;action_type.disabled=!1;action_text.disabled=!1;action_link.disabled=!1;action_btn.value="Add Action";alertify.log("An error occured when attempting to proccess your request, please try again later","error");return!1},success:function(e){var t=e.split(":");if(t[0]=="1"){action_btn.disabled=!1;action_type.disabled=!1;action_text.disabled=!1;action_link.disabled=!1;action_text.value="";action_link.value="";action_btn.value="Add Action";alertify.log("Added action point","success");updateActionList()}else{action_btn.disabled=!1;action_type.disabled=!1;action_text.disabled=!1;action_link.disabled=!1;action_btn.value="Add Action";alertify.log(t[1],"error")}return!1}})}function deleteAction(e){var t=document.getElementById("causeid"),n="cid="+t.value+"&aid="+e;$.ajax({type:"POST",url:"/scripts/processing/deleteaction.php",data:n,beforeSend:function(){console.log("Deleting action")},error:function(){console.log("Error deleting action");return!1},success:function(e){updateActionList();console.log("Deleted action");return!1}})}function updateActionList(){var e=document.getElementById("causeid"),t="cid="+e.value;$.ajax({type:"POST",url:"/scripts/processing/actionlist_edit.php",data:t,beforeSend:function(){console.log("Updating actions")},error:function(){console.log("Error updating actions");return!1},success:function(e){document.getElementById("actionpointlist").innerHTML=e;console.log("Updated actions");return!1}})}function updateEditForm(){var e=document.getElementById("causeid"),t=document.getElementById("action_type"),n="cid="+e.value+"&mid="+t.value;$.ajax({type:"POST",url:"/modules/display_edit_form.php",data:n,beforeSend:function(){document.getElementById("communitymodulefields").innerHTML="Loading...";console.log("Updating module edit form")},error:function(){document.getElementById("communitymodulefields").innerHTML="";console.log("Error updating module edit form");return!1},success:function(e){document.getElementById("communitymodulefields").innerHTML=e;console.log("Updated module edit form");return!1}})}function updateLobbyList(e){var t=document.getElementById("causeid"),n=document.getElementById("causetags"),r="cid="+t.value+"&type="+e+"&tags="+n.value;$.ajax({type:"POST",url:"/scripts/processing/lobbylist.php",data:r,beforeSend:function(){document.getElementById("lobbylist").innerHTML='<button style="margin-bottom: 5px; width: 100%;">Loading...</button><br><button style="margin-bottom: 5px; width: 100%;">Loading...</button><br><button style="margin-bottom: 5px; width: 100%;">Loading...</button><br><button style="margin-bottom: 5px; width: 100%;">Loading...</button><br><button style="margin-bottom: 5px; width: 100%;">Loading...</button>';console.log("Updating lobby list")},error:function(){console.log("Error updating lobby list");return!1},success:function(e){document.getElementById("lobbylist").innerHTML=e;console.log("Updated lobby list");return!1}})}$("#communitymoduleform").submit(function(e){action_btn=document.getElementById("communitymodulesubmit");var t=$(this).serializeArray(),n=$(this).attr("action");$.ajax({url:n,type:"POST",data:t,beforeSend:function(){action_btn.value="Processing";action_btn.disabled=!0},error:function(e,t,n){alertify.log("An error occured when attempting to proccess your request, please try again later","error");action_btn.value="Add Module";action_btn.disabled=!1},success:function(e,t,n){var r=e.split(":");alertify.log(r[1],r[0]);action_btn.value="Add Module";action_btn.disabled=!1;r[0]=="success"&&updateEditForm()}});e.preventDefault()});